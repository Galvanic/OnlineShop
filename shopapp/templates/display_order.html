{% extends "base.html" %}
{% block title %}Order {{ order['id'] }}{% endblock %}
{% block content %}

<h1>Order {{ order['id'] }}</h1>
<h5>Made on {{ order['delivery_date'] }}</h5>

<div id='baskets'>
  {% if baskets %}
    <h2>Each flatmate owes:</h2>
    <table>
    {% for flatmate, contribution in baskets.items %}
      <tr>
        <td>{{ flatmate }}</td>
        <td>{{ contribution }}</td>
      </tr>
    {% endfor %}
    </table>
    <a href="{{ url_for('assign_order', order_id=order['id']) }}">Re-assign this order</a>
  {% else %}
    <a href="{{ url_for('assign_order', order_id=order['id']) }}">Assign this order</a>
  {% endif %}
</div>

<div id='purchases'>
  <h2>Purchases</h2>
  <table>
  {% for purchase, assigned_to in purchases %}
    <tr>
      <td>{{ purchase['quantity'] }}</td>
      <td>{{ purchase['description'] }}</td>
      <td>{{ purchase['price'] }}</td>
      <td>
        <ul>
        {% for flatmate in assigned_to|sort %}
          <li>{{ flatmate }}</li>
        {% endfor %}
        </ul>
      </td>
    </tr>
  {% endfor %}
  </table>
</div>


{% endblock %}